{"version":3,"sources":["components/Dialogs/Dialogs.module.css","components/Dialogs/Dialog/Dialog.module.css","components/Dialogs/Messages/Messages.module.css","components/Dialogs/Messages/Message/Message.module.css","assets/icons/tg.png","components/Dialogs/Dialog/Dialog.jsx","components/Dialogs/Messages/Message/Message.jsx","components/Dialogs/Messages/Messages.jsx","components/Dialogs/Messages/MessagesContainer.jsx","components/Dialogs/Dialogs.jsx","hoc/withAuthRedirect.jsx","components/Dialogs/DialogsContainer.jsx"],"names":["module","exports","Dialog","props","stringToSplit","separator","newDate","date","split","className","s","dialog","to","id","activeClassName","active","dialog_start","dialog_avatar","src","avatar","alt","dialog_body","dialog_name","name","dialog_message","dialog_end","dialog_date","Message","time","message","msgClass","message_body","message_start","message_avatar","senderId","authProfile","userId","resProfile","data","photos","small","defaultAvatar","message_content","message_name","message_text","text","message_date","maxLength300","maxLengthCreator","AddMessageFormRedux","reduxForm","form","onSubmit","handleSubmit","messages_form","Field","component","Textarea","validate","placeholder","messages_textarea","send","send_button","Messages","MessagesElements","messages","map","m","body","key","addedAt","senderName","messages__wrap","typing_wrap","length","values","openedUserId","sendMessage","MessagesContainer","this","refreshProfile","prevProps","prevState","snapshot","match","params","userID","getRecipienProfile","React","Component","compose","connect","state","newMessageText","dialogsPage","profilePage","withRouter","Dialogs","DialogElements","dialogs","item","userName","lastDialogActivityDate","isAuth","dialogs__wrap","messages_wrap","store","mapStateToPropsForRedirect","auth","DialogsContainer","getDialogs","setOpenedUserId","getMessages","startDialog","RedirectComponent"],"mappings":"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","file":"static/js/4.9066ee28.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialogs__wrap\":\"Dialogs_dialogs__wrap__3XkBp\",\"messages_wrap\":\"Dialogs_messages_wrap__1TLTe\",\"dialogs\":\"Dialogs_dialogs__17yrP\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dialog\":\"Dialog_dialog__2WcIH\",\"dialog_avatar\":\"Dialog_dialog_avatar__21v_y\",\"dialog_body\":\"Dialog_dialog_body__37Pr9\",\"dialog_name\":\"Dialog_dialog_name__1Z3vb\",\"dialog_message\":\"Dialog_dialog_message__2DpvB\",\"dialog_date\":\"Dialog_dialog_date__2fvku\",\"active\":\"Dialog_active__15CzB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"messages_form\":\"Messages_messages_form__3yWwc\",\"typing_wrap\":\"Messages_typing_wrap__VaomH\",\"messages__wrap\":\"Messages_messages__wrap__3TZXn\",\"messages\":\"Messages_messages__5u0PW\",\"messages_textarea\":\"Messages_messages_textarea__2FCu9\",\"send\":\"Messages_send__2Yqln\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message\":\"Message_message__2g7eV\",\"message_header\":\"Message_message_header__15HX6\",\"message_name\":\"Message_message_name__1BIw2\",\"message_text\":\"Message_message_text__CxvOO\",\"message_date\":\"Message_message_date__1C7Yr\",\"message_body\":\"Message_message_body__3lG1a\",\"message_avatar\":\"Message_message_avatar__1qG2J\"};","module.exports = __webpack_public_path__ + \"static/media/tg.3f925d6c.png\";","import React from 'react'\nimport s from './Dialog.module.css'\nimport {NavLink} from \"react-router-dom\";\n\nconst Dialog = (props) => {\n\n\tlet splitString = (stringToSplit, separator) => {\n\t\treturn stringToSplit.split(separator);\n\t}\n\n\tlet newDate = splitString(props.date, 'T');\n\n\treturn (\n\t\t<div className={s.dialog}>\n\t\t\t<NavLink to={`/im/${props.id}`} activeClassName={s.active}>\n\t\t\t\t<div className={s.dialog_start}>\n\t\t\t\t\t<div className={s.dialog_avatar}>\n\t\t\t\t\t\t<img src={props.avatar} alt=\"avatar\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={s.dialog_body}>\n\t\t\t\t\t<div className={s.dialog_name}>\n\t\t\t\t\t\t{props.name}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={s.dialog_message}>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={s.dialog_end}>\n\t\t\t\t\t<div className={s.dialog_date}>\n\t\t\t\t\t\t{newDate[0]}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</NavLink>\n\t\t</div>\n\t);\n};\n\nexport default Dialog","import React from 'react'\nimport s from './Message.module.css'\nimport {NavLink} from \"react-router-dom\";\nimport defaultAvatar from \"./../../../../assets/images/default_avatar.png\";\n\nconst Message = (props) => {\n\n    let date = props.date.split('T');\n    let time = date[1].split('.');\n\n    return (\n        <div className={`${s.message} ${s[props.msgClass]}`}>\n            <div className={s.message_body}>\n                <div className={s.message_start}>\n                    <div className={s.message_avatar}>\n                        {props.senderId !== props.authProfile.userId &&\n                            <img src={props.resProfile.data.photos.small ? props.resProfile.data.photos.small : defaultAvatar} alt=\"avatar\"/>\n                        }\n                        {props.senderId === props.authProfile.userId &&\n                            <img src={props.authProfile.photos.small ? props.authProfile.photos.small : defaultAvatar} alt=\"avatar\"/>\n                        }\n                    </div>\n                </div>\n                <div className={s.message_content}>\n                    <NavLink to={\"/profile/\"+props.userId} className={s.message_name}>{props.name}</NavLink>\n                    <div className={s.message_text}>\n                        {props.text}\n                    </div>\n                </div>\n            </div>\n            <div className={s.message_date}>\n                <span>{date[0]}</span>\n                <span>{time[0]}</span>\n            </div>\n        </div>\n    );\n};\n\nexport default Message","import React from 'react'\nimport s from './Messages.module.css'\nimport Message from \"./Message/Message\";\nimport {Field, reduxForm, reset} from \"redux-form\";\nimport {Textarea} from \"../../common/FormsControls/FormsControls\";\nimport {maxLengthCreator} from \"../../../utils/validators/validators\";\nimport send_button from './../../../assets/icons/tg.png'\n\n\nconst Messages = (props) => {\n\n\tlet MessagesElements = props.messages ? props.messages.map(m => <Message resProfile={props.resProfile} authProfile={props.authProfile} senderId={m.senderId} text={m.body} key={m.id} date={m.addedAt} name={m.senderName}/>) : '';\n\n\tlet onSubmit = (values) => {\n\t\tif(props.openedUserId){\n\t\t\tprops.sendMessage(props.openedUserId, values.body);\n\t\t}\n\t}\n\n\treturn (\n\t\t<div className={s.messages__wrap}>\n\t\t\t<div className={s.messages}>\n\t\t\t\t{MessagesElements}\n\t\t\t</div>\n\t\t\t<div className={s.typing_wrap}>\n\t\t\t\t{MessagesElements.length === 0 && 'Нет сообщений'}\n\t\t\t</div>\n\t\t\t<AddMessageFormRedux onSubmit={onSubmit}/>\n\t\t</div>\n\n\t);\n};\n\nconst maxLength300 = maxLengthCreator(300)\n\nconst AddMessageForm = (props) => {\n\n\treturn (\n\t\t<form onSubmit={props.handleSubmit} className={s.messages_form}>\n\t\t\t<Field component={Textarea} validate={[maxLength300]} placeholder=\"Write a message...\"\n\t\t\t       className={s.messages_textarea}\n\t\t\t       name=\"body\"/>\n\t\t\t<button className={s.send}>\n\t\t\t\t<img src={send_button}\n\t\t\t\t     alt=\"send\"/>\n\t\t\t</button>\n\t\t</form>\n\t)\n}\n\nconst AddMessageFormRedux = reduxForm({form: 'dialogAddMessageForm'} )(AddMessageForm)\n\nexport default Messages","import React from 'react'\nimport Messages from \"./Messages\";\nimport {connect} from \"react-redux\";\nimport {getRecipienProfile, sendMessage} from \"../../../redux/dialogs-reducer\";\nimport {compose} from \"redux\";\nimport {withRouter} from \"react-router-dom\";\n\nclass MessagesContainer extends React.Component {\n\trender() {\n\t\treturn <Messages {...this.props} sendMessage={this.props.sendMessage}/>\n\t}\n\n\n\tcomponentDidMount() {\n\t\tthis.refreshProfile();\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (this.props.match.params.userId !== prevProps.match.params.userId) {\n\t\t\tthis.refreshProfile();\n\t\t}\n\t}\n\n\trefreshProfile() {\n\t\tlet userID = this.props.match.params.userId;\n\t\tif (userID) {\n\t\t\tthis.props.getRecipienProfile(userID);\n\t\t}\n\t}\n}\n\nlet mapStateToProps = (state) => {\n\treturn {\n\t\tnewMessageText: state.dialogsPage.newMessageText,\n\t\tmessages: state.dialogsPage.messages,\n\t\topenedUserId: state.dialogsPage.openedUserId,\n\t\tresProfile: state.dialogsPage.resProfile,\n\t\tauthProfile: state.profilePage.authProfile\n\t}\n}\n\nexport default compose(\n\tconnect(mapStateToProps, {sendMessage, getRecipienProfile}),\n\twithRouter)(MessagesContainer)","import React from 'react'\nimport s from './Dialogs.module.css'\nimport Dialog from \"./Dialog/Dialog\";\nimport MessagesContainer from \"./Messages/MessagesContainer\";\nimport {Redirect} from \"react-router-dom\";\n\nconst Dialogs = (props) => {\n\tlet DialogElements = props.dialogs && props.dialogs.length > 0 ? props.dialogs.map(item => <Dialog name={item.userName}\n\t                                                       date={item.lastDialogActivityDate} key={item.id}\n\t                                                       avatar={item.photos.small}\n\t                                                       id={item.id}/>) : '';\n\tif (!props.isAuth) return <Redirect to={'/auth'}/>\n\n\treturn (\n\t\t<div className={s.dialogs__wrap}>\n\t\t\t<div className={s.dialogs}>\n\t\t\t\t{DialogElements}\n\t\t\t</div>\n\t\t\t<div className={s.messages_wrap}>\n\t\t\t\t<MessagesContainer store={props.store}/>\n\t\t\t</div>\n\t\t</div>\n\t)\n};\n\n\nexport default Dialogs","import React from 'react'\nimport {Redirect} from \"react-router-dom\";\nimport {connect} from \"react-redux\";\n\nlet mapStateToPropsForRedirect = (state) => ({\n\tisAuth: state.auth.isAuth\n})\n\nexport const withAuthRedirect = (Component) => {\n\tclass RedirectComponent extends React.Component {\n\t\trender(){\n\t\t\tif(!this.props.isAuth) return <Redirect to={'/auth'}/>\n\t\t\treturn <Component {...this.props}/>\n\t\t}\n\t}\n\n\tlet ConnectedRedirectComponent = connect(mapStateToPropsForRedirect)(RedirectComponent);\n\n\treturn ConnectedRedirectComponent\n}\n","import React from 'react'\nimport Dialogs from './Dialogs'\nimport {connect} from \"react-redux\";\nimport {withAuthRedirect} from \"../../hoc/withAuthRedirect\";\nimport {compose} from \"redux\";\nimport {\n\tgetDialogs,\n\tgetMessages,\n\tgetRecipienProfile,\n\tsendMessage,\n\tsetOpenedUserId,\n\tstartDialog\n} from \"../../redux/dialogs-reducer\";\nimport {withRouter} from \"react-router-dom\";\n\nclass DialogsContainer extends React.Component {\n\n\tcomponentDidMount() {\n\t\tthis.props.getDialogs();\n\t\tthis.refreshProfile();\n\t}\n\n\tcomponentDidUpdate(prevProps, prevState, snapshot) {\n\t\tif (this.props.match.params.userId !== prevProps.match.params.userId) {\n\t\t\tthis.refreshProfile();\n\t\t}\n\t}\n\n\trefreshProfile() {\n\t\tlet userID = this.props.match.params.userId;\n\t\tif (userID) {\n\t\t\tthis.props.setOpenedUserId(userID);\n\t\t\tthis.props.getMessages(userID);\n\t\t}\n\t\tif(!userID){\n\t\t\tthis.props.setOpenedUserId(null);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn <Dialogs {...this.props} startDialog={this.props.startDialog}/>\n\t}\n}\n\n\nlet mapStateToProps = (state) => {\n\treturn {\n\t\tdialogs: state.dialogsPage.dialogs,\n\t\tisAuth: state.auth.isAuth,\n\t}\n}\n\nexport default compose(\n\tconnect(mapStateToProps, {getDialogs, startDialog, getMessages, sendMessage, setOpenedUserId}),\n\twithRouter,\n\twithAuthRedirect\n)(DialogsContainer)"],"sourceRoot":""}